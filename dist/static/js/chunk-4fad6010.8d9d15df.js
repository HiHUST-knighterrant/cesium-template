(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fad6010"],{"39b4":function(n,e,t){"use strict";t.r(e);var a=function(){var n=this,e=n.$createElement;n._self._c;return n._m(0)},i=[function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"container"},[t("div",{attrs:{id:"cesiumContainer"}})])}],r=t("9192"),s=(t("2afa"),t("9e48")),o=t("dd8c"),c=[{lon:123.42953620485503,lat:41.81694999200361,name:"沈阳北站",data:{num:108}},{lon:123.43382736814452,lat:41.811201240193164,name:"惠工广场",data:{num:203}},{lon:123.42779707065701,lat:41.80227802016961,name:"市府广场",data:{num:500}}],l=[{codeLanguage:"VUE",relyOn:[{label:"Entity.js",url:"cesium/Entity.js"},{label:"Canvas.js",url:"cesium/Canvas.js"},{label:"data.js",url:"Vue/Entity/canvasImageSpot/data.js"},{label:"textPnl.png",url:"Vue/Entity/canvasImageSpot/textPnl.png"}],code:[{codeLanguage:"html",content:' <div class="container">\n                    <div id="cesiumContainer"></div>\n                  </div>'},{codeLanguage:"js",content:'import Entity from "@/common/cesium/Entity.js";\n                  import Canvas from "@/common/cesium/Canvas.js";\n                  import positionData from "./module/data";\n                  export default {\n                    name: "canvasImageSpot",\n                    data() {\n                      return {\n                        viewer: null,\n                        _Entity: null,\n                        _Canvas: null,\n                        positionData: positionData,\n                        //广告牌数据\n                        billboardArr: [],\n                      };\n                    },\n                    mounted() {\n                      this.init();\n                    },\n                    methods: {\n                      init() {\n                        const Cesium = this.cesium;\n                        Cesium.Ion.defaultAccessToken = process.env.VUE_APP_TOKEN;\n                        this.viewer = new Cesium.Viewer("cesiumContainer", {\n                          imageryProvider: new Cesium.ArcGisMapServerImageryProvider({\n                            url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",\n                          }),\n                          terrainProvider: new Cesium.CesiumTerrainProvider({\n                            //加载火星在线地形\n                            url: "http://data.marsgis.cn/terrain",\n                          }),\n                          shouldAnimate: true,\n                          infoBox: false,\n                          selectionIndicator: false,\n                        });\n                        //设置贴地效果\n                        this.viewer.scene.globe.depthTestAgainstTerrain = false;\n                        this._Entity = new Entity(Cesium, this.viewer);\n                        this._Canvas = new Canvas(Cesium, this.viewer);\n                        this.start();\n                      },\n                      /**\n                       * 开始\n                       */\n                      start() {\n                        const Cesium = this.cesium;\n                  \n                        this.positionData.map((item) => {\n                          const imageReq = this._Canvas.drawImageText({\n                            ...item,\n                            height: 140,\n                            width: 300,\n                            src: "/image/textPnl.png",\n                          });\n                          imageReq.then((image) => {\n                            const _createBillboard = this._Entity.createBillboard({\n                              position: Cesium.Cartesian3.fromDegrees(item.lon, item.lat, 0),\n                              image,\n                              scaleByDistance: new Cesium.NearFarScalar(1.5e2, 1.0, 1.5e7, 0.2),\n                              translucencyByDistance: new Cesium.NearFarScalar(\n                                1.5e2,\n                                1.0,\n                                1.5e7,\n                                0.2\n                              ),\n                              verticalOrigin: Cesium.VerticalOrigin.BOTTOM,\n                              width: 150,\n                              height: 70,\n                              heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\n                            });\n                            this.billboardArr.push(_createBillboard);\n                          });\n                        });\n                  \n                        //相机(定位到了 沈河区惠工广场)\n                        this.viewer.camera.flyTo({\n                          //setView是直接跳到 flyTo// 是镜头飞行到  网速不好或者电脑配置不高 还是不要fly了吧\n                          destination: Cesium.Cartesian3.fromDegrees(\n                            123.43382736814452,\n                            41.811201240193164,\n                            5000\n                          ), //经纬度坐标转换为 笛卡尔坐标(世界坐标)\n                          orientation: {\n                            heading: Cesium.Math.toRadians(0.0), // east, default value is 0.0 (north) //东西南北朝向\n                            pitch: Cesium.Math.toRadians(-90), // default value (looking down)  //俯视仰视视觉\n                            roll: 0.0, // default value\n                          },\n                          duration: 3, //3秒到达战场\n                        });\n                  \n                        setTimeout(() => {\n                          this.updateBillboard();\n                        }, 8000);\n                      },\n                      /**\n                       * 开始更新广告牌\n                       */\n                      updateBillboard() {\n                        setInterval(() => {\n                          this.billboardArr.map((item) => {\n                            const imageReq = this._Canvas.drawImageText({\n                              ...item,\n                              height: 140,\n                              width: 300,\n                              src: "/image/textPnl.png",\n                              data: {\n                                num: Math.round(Math.random() * (0 - 1000) + 1000),\n                              },\n                            });\n                            imageReq.then((image) => {\n                              item._billboard._image._value = image;\n                            });\n                          });\n                        }, 3000);\n                      },\n                    },\n                  };'},{codeLanguage:"css",content:".container {\n                    width: 100%;\n                    height: 100%;\n                    #cesiumContainer {\n                      width: 100%;\n                      height: 100%;\n                    }\n                  }"}]},{codeLanguage:"JS",relyOn:[{label:"Entity.js",url:"JavaScript/cesium/Entity.js"},{label:"Canvas.js",url:"JavaScript/cesium/Canvas.js"},{label:"textPnl.png",url:"JavaScript/Entity/canvasImageSpot/textPnl.png"}],code:[{codeLanguage:"js",content:'function canvasSpot() {\n                      const _Canvas = new Canvas(Cesium, viewer);\n                      const _Entity = new Entity(Cesium, viewer);\n                  \n                      let canvasSpotData = {\n                          positionData: [\n                              {\n                                  lon: 123.42953620485503,\n                                  lat: 41.81694999200361,\n                                  name: "沈阳北站",\n                                  data: {\n                                      num: 108,\n                                  },\n                              },\n                              {\n                                  lon: 123.43382736814452,\n                                  lat: 41.811201240193164,\n                                  name: "惠工广场",\n                                  data: {\n                                      num: 203,\n                                  },\n                              },\n                              {\n                                  lon: 123.42779707065701,\n                                  lat: 41.80227802016961,\n                                  name: "市府广场",\n                                  data: {\n                                      num: 500,\n                                  },\n                              },\n                          ],\n                          //广告牌数据\n                          billboardArr: [],\n                      }\n                      //初始化绘制\n                      canvasSpotData.positionData.map((item) => {\n                          const imageReq = _Canvas.drawImageText({\n                              ...item,\n                              height: 140,\n                              width: 300,\n                              src: "../images/test/textPnl.png",\n                          });\n                          imageReq.then((image) => {\n                              const _createBillboard = _Entity.createBillboard({\n                                  position: Cesium.Cartesian3.fromDegrees(item.lon, item.lat, 0),\n                                  image,\n                                  scaleByDistance: new Cesium.NearFarScalar(1.5e2, 1.0, 1.5e7, 0.2),\n                                  translucencyByDistance: new Cesium.NearFarScalar(\n                                      1.5e2,\n                                      1.0,\n                                      1.5e7,\n                                      0.2\n                                  ),\n                                  verticalOrigin: Cesium.VerticalOrigin.BOTTOM,\n                                  width: 150,\n                                  height: 70,\n                                  heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\n                              });\n                              canvasSpotData.billboardArr.push(_createBillboard);\n                          });\n                      });\n                  \n                      //相机(定位到了 沈河区惠工广场)\n                      this.viewer.camera.flyTo({\n                          //setView是直接跳到 flyTo// 是镜头飞行到  网速不好或者电脑配置不高 还是不要fly了吧\n                          destination: Cesium.Cartesian3.fromDegrees(\n                              123.43382736814452,\n                              41.811201240193164,\n                              5000\n                          ), //经纬度坐标转换为 笛卡尔坐标(世界坐标)\n                          orientation: {\n                              heading: Cesium.Math.toRadians(0.0), // east, default value is 0.0 (north) //东西南北朝向\n                              pitch: Cesium.Math.toRadians(-90), // default value (looking down)  //俯视仰视视觉\n                              roll: 0.0, // default value\n                          },\n                          duration: 3, //3秒到达战场\n                      });\n                  \n                      // 8秒以后 执行更新数据操作\n                      setTimeout(() => {\n                          updateBillboard();\n                      }, 8000);\n                  \n                      function updateBillboard() {\n                          //每3秒执行一次操作\n                          setInterval(() => {\n                              canvasSpotData.billboardArr.map((item) => {\n                                  const imageReq = _Canvas.drawImageText({\n                                      ...item,\n                                      height: 140,\n                                      width: 300,\n                                      src: "../images/test/textPnl.png",\n                                      data: {\n                                          num: Math.round(Math.random() * (0 - 1000) + 1000),\n                                      },\n                                  });\n                                  imageReq.then((image) => {\n                                      item._billboard._image._value = image;\n                                  });\n                              });\n                          }, 3000);\n                      }\n                  \n                  }\n                  //启动\n                  canvasSpot()'}]}],u={name:"canvasImageSpot",data:function(){return{viewer:null,_Entity:null,_Canvas:null,positionData:c,billboardArr:[]}},created:function(){this.$store.dispatch("highlight/set_code",l)},mounted:function(){this.init()},methods:{init:function(){var n=this.cesium;n.Ion.defaultAccessToken=Object({NODE_ENV:"production",VUE_APP_BASE_API:"/prod-api",VUE_APP_GAODE_KEY_WEB_SERVICE:"181ced609de9d446207b55e549bafcb6",VUE_APP_GAODE_KEY_WEB_TERMINAL:"cb250acd7ee0e7b2049cb93747ae3d44",VUE_APP_PUBLIC_URL:"/cesium-template",VUE_APP_QINIU_URL:"http://re8r7gk9l.hb-bkt.clouddn.com",VUE_APP_SECURITY_JS_CODE:"2a0ce2005352672661417093c485a056",VUE_APP_TIANDITU_KEY:"03711cd3e505e56468807c348f271df0",BASE_URL:"/cesium-template/"}).VUE_APP_TOKEN,this.viewer=new n.Viewer("cesiumContainer",{imageryProvider:new n.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),terrainProvider:new n.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"}),shouldAnimate:!0,infoBox:!1,selectionIndicator:!1}),this.viewer.scene.globe.depthTestAgainstTerrain=!1,this._Entity=new s["a"](n,this.viewer),this._Canvas=new o["a"](n,this.viewer),this.start()},start:function(){var n=this,e=this.cesium;this.positionData.map((function(t){var a=n._Canvas.drawImageText(Object(r["a"])(Object(r["a"])({},t),{},{height:140,width:300,src:"/cesium-template/image/textPnl.png"}));a.then((function(a){var i=n._Entity.createBillboard({position:e.Cartesian3.fromDegrees(t.lon,t.lat,0),image:a,scaleByDistance:new e.NearFarScalar(150,1,15e6,.2),translucencyByDistance:new e.NearFarScalar(150,1,15e6,.2),verticalOrigin:e.VerticalOrigin.BOTTOM,width:150,height:70,heightReference:e.HeightReference.CLAMP_TO_GROUND});n.billboardArr.push(i)}))})),this.viewer.camera.flyTo({destination:e.Cartesian3.fromDegrees(123.43382736814452,41.811201240193164,5e3),orientation:{heading:e.Math.toRadians(0),pitch:e.Math.toRadians(-90),roll:0},duration:3}),setTimeout((function(){n.updateBillboard()}),8e3)},updateBillboard:function(){var n=this;setInterval((function(){n.billboardArr.map((function(e){var t=n._Canvas.drawImageText(Object(r["a"])(Object(r["a"])({},e),{},{height:140,width:300,src:"/cesium-template/image/textPnl.png",data:{num:Math.round(-1e3*Math.random()+1e3)}}));t.then((function(n){e._billboard._image._value=n}))}))}),3e3)}}},m=u,d=(t("bd76"),t("cba8")),h=Object(d["a"])(m,a,i,!1,null,"f6c299c8",null);e["default"]=h.exports},"4bb1":function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));t("a567");function a(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}},"78be":function(n,e,t){var a=t("46a7"),i=t("bc35"),r=t("5386");a({target:"Array",proto:!0},{fill:i}),r("fill")},bc35:function(n,e,t){"use strict";var a=t("735b"),i=t("32da"),r=t("1c60");n.exports=function(n){var e=a(this),t=r(e),s=arguments.length,o=i(s>1?arguments[1]:void 0,t),c=s>2?arguments[2]:void 0,l=void 0===c?t:i(c,t);while(l>o)e[o++]=n;return e}},bd76:function(n,e,t){"use strict";t("e2c7")},dd8c:function(n,e,t){"use strict";var a=t("26b6"),i=t("76eb"),r=t("4bb1"),s=t("e143"),o=(t("eb3b"),function(){function n(e,t){Object(r["a"])(this,n),this.Cesium=e,this.viewer=t}return Object(s["a"])(n,[{key:"drawText",value:function(n){var e=n.text,t=document.createElement("canvas"),a=(e+"").length*n.fontSize;t.width=a,t.height=n.fontSize;var i=t.getContext("2d");return i.fillStyle=n.color,i.font="bold "+n.fontSize+"px 微软雅黑",i.textBaseline="hanging",i.fillText(e,0,0),t}},{key:"drawImageText",value:function(){var n=Object(i["a"])(Object(a["a"])().mark((function n(e){return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(n,t){var a,i=document.createElement("img");i.src=e.src,i.onload=function(){a=document.createElement("canvas"),a.height=e.height,a.width=e.width;var t=a.getContext("2d");t.clearRect(0,0,a.width,a.height),t.drawImage(i,0,0),t.font="30px bold 楷体",t.fillStyle="#fff";var r="阳性："+e.data.num;t.fillText(r,(a.width-30*r.length)/2,(a.height+30)/2),n(a)}}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));function e(e){return n.apply(this,arguments)}return e}()},{key:"combineIconAndLabel",value:function(n){var e=n.url,t=n.label,a=n.size,i=this.Cesium,r=document.createElement("canvas");r.width=a,r.height=a;var s=r.getContext("2d"),o=new i.Resource.fetchImage(e).then((function(n){try{s.drawImage(n,0,0)}catch(e){console.log(e)}return s.fillStyle=i.Color.WHITE.toCssColorString(),s.font="bold 20px Microsoft YaHei",s.textAlign="center",s.textBaseline="middle",s.fillText(t,a/2,a/2),r}));return o}}]),n}());e["a"]=o},e143:function(n,e,t){"use strict";function a(n,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}function i(n,e,t){return e&&a(n.prototype,e),t&&a(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}t.d(e,"a",(function(){return i}))},e2c7:function(n,e,t){}}]);