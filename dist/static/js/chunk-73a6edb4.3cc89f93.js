(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73a6edb4"],{"21b7":function(e,t,n){},"4cef":function(e,t,n){"use strict";var i=n("c15f"),a=n("a35b"),o=function(){function e(t,n){Object(i["a"])(this,e),this.Cesium=t,this.viewer=n}return Object(a["a"])(e,[{key:"create",value:function(e){var t=this.Cesium,n=this.viewer,i=null!==e&&void 0!==e&&e.cesiumName?e.cesiumName:"",a=null!==e&&void 0!==e&&e.source?e.source:"",o=null!==e&&void 0!==e&&e.uniforms?e.uniforms:"";function l(){this._definitionChanged=new t.Event,this._color=void 0,this._colorSubscription=void 0,this.color=null!==e&&void 0!==e&&e.color?e.color:t.Color.BLUE,this.duration=null!==e&&void 0!==e&&e.duration?e.duration:1e3,this.image=null!==e&&void 0!==e&&e.image?e.image:"",this._time=(new Date).getTime()}Object.defineProperties(l.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:t.createPropertyDescriptor("color")});var r="Material".concat(parseInt(1e3*Math.random()));return l.prototype.getType=function(e){return r},l.prototype.getValue=function(e,i){return t.defined(i)||(i={}),i.color=t.Property.getValueOrClonedDefault(this._color,e,t.Color.WHITE,i.color),i.image=this.image,this.duration&&(i.time=((new Date).getTime()-this._time)%this.duration/this.duration),n.scene.requestRender(),i},l.prototype.equals=function(e){return this===e||e instanceof l&&t.Property.equals(this._color,e._color)},t.Material._materialCache.addMaterial(r,{fabric:{type:r,uniforms:o,source:a},translucent:function(e){return!0}}),t[i]=l,l}}]),e}();t["a"]=o},"50ff":function(e,t,n){},8968:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{attrs:{id:"cesiumContainer"}}),n("el-button",{staticClass:"tools",attrs:{type:"primary",icon:"el-icon-s-tools",circle:""},on:{click:function(t){e.poiPanelShow=!e.poiPanelShow}}}),n("poi-Panel",{attrs:{show:e.poiPanelShow},on:{close:function(t){e.poiPanelShow=!1},load:e.load,poisClick:e.poisClick}})],1)},a=[],o=n("d941"),l=n("c3ae"),r=(n("840d"),n("a256"),n("e4b5"),n("209b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{attrs:{title:"操作面板",visible:e.drawer,size:"500px",direction:"rtl","before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[n("div",{staticClass:"POI-panel"},[n("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.panelType,callback:function(t){e.panelType=t},expression:"panelType"}},e._l(e.panelTypeArr,(function(e,t){return n("el-tab-pane",{key:t,attrs:{label:e.label,name:e.value}})})),1),"1"==e.panelType?n("section",{staticClass:"pois"},[n("div",{staticClass:"form-view"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[e._v("范围：")]),n("div",{staticClass:"form-value"},[n("el-radio-group",{attrs:{size:"mini"},on:{change:e.search},model:{value:e.range,callback:function(t){e.range=t},expression:"range"}},[n("el-radio",{attrs:{label:"city"}},[e._v("城市")]),n("el-radio",{attrs:{label:"all"}},[e._v("全国")])],1)],1)]),n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[e._v("城市：")]),n("div",{staticClass:"form-value"},[n("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",disabled:"all"==e.range,props:{children:"districtList",label:"name",value:"adcode"},placeholder:"城市选择...",options:e.cityOptions},on:{change:e.search},model:{value:e.city,callback:function(t){e.city=t},expression:"city"}})],1)]),n("div",{staticClass:"form-item multiple"},[n("div",{staticClass:"form-label"},[e._v("兴趣点类别：")]),n("div",{staticClass:"form-value"},[n("el-select",{staticClass:"select",attrs:{size:"mini",multiple:"",placeholder:"请选择兴趣类别（可多选）"},on:{change:e.search},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.placeSearchType,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)]),n("div",{staticClass:"form-item multiple"},[n("div",{staticClass:"form-label"},[e._v("是否聚合：")]),n("div",{staticClass:"form-value"},[n("el-switch",{attrs:{size:"mini","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.search},model:{value:e.polymerization,callback:function(t){e.polymerization=t},expression:"polymerization"}})],1)]),n("div",{staticClass:"form-item search"},[n("el-input",{attrs:{size:"mini",placeholder:"请输入搜索关键词",clearable:""},on:{change:e.search},model:{value:e.keyword,callback:function(t){e.keyword="string"===typeof t?t.trim():t},expression:"keyword"}}),n("el-button",{staticClass:"button",attrs:{disabled:""==e.keyword,type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1)]),n("div",{staticClass:"main"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"poisList",staticClass:"item-view"},e._l(e.poisList,(function(t,i){return n("div",{key:t.id+i,staticClass:"pois-item",on:{click:function(n){return e.poisClick(t)}}},[n("div",{staticClass:"pois-item-image"},[0!=t.photos.length?n("el-image",{staticClass:"image",attrs:{src:t.photos[0].url,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])]):n("el-image",{staticClass:"image",attrs:{src:"",fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])])],1),n("div",{staticClass:"pois-item-text"},[n("h3",[e._v(e._s(t.name))]),n("p",[e._v(" 电话： "),t.tel?[e._v(e._s(t.tel))]:[e._v("-")]],2),n("p",[e._v(" 类目： "+e._s(t.type)+" ")]),n("p",[e._v(" 地址： "+e._s(t.pname)+e._s(t.cityname)+e._s(t.adname)+e._s(t.address)+" ")])])])})),0),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{"hide-on-single-page":"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.pageIndex},on:{"current-change":e.currentPaginationChange}})],1)])]):e._e(),"2"==e.panelType?n("section",{staticClass:"navigation"},[n("div",{staticClass:"form-view"},[n("el-form",{ref:"form",attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"起始位置："}},[n("el-input",{attrs:{size:"mini",placeholder:"请输入起始位置",id:"startPosition"},model:{value:e.startPosition,callback:function(t){e.startPosition="string"===typeof t?t.trim():t},expression:"startPosition"}})],1),n("el-form-item",{attrs:{label:"终点位置："}},[n("el-input",{attrs:{size:"mini",placeholder:"请输入终点位置",id:"endPosition"},model:{value:e.endPosition,callback:function(t){e.endPosition="string"===typeof t?t.trim():t},expression:"endPosition"}})],1),n("el-form-item",{attrs:{label:"类型："}},[n("el-radio-group",{attrs:{disabled:"{}"==JSON.stringify(e.startPositionResult)||"{}"==JSON.stringify(e.endPositionResult),size:"mini"},on:{change:e.navigationTypeChange},model:{value:e.navigationType,callback:function(t){e.navigationType=t},expression:"navigationType"}},e._l(e.navigationTypeArr,(function(t,i){return n("el-radio-button",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)],1)],1),n("div",{staticClass:"steps-view",attrs:{id:"panel"}})]):e._e()],1)])}),s=[],c=(n("1ce2"),n("b782"),n("9afd"),n("095e"),n("c407")),u=n("c15f"),d=n("a35b"),p=(n("3d49"),n("3b45"),function(){function e(t){Object(u["a"])(this,e),this.AMap=t}return Object(d["a"])(e,[{key:"districtList",value:function(e){var t=this.AMap,n={level:null!==e&&void 0!==e&&e.level?e.level:"country",subdistrict:null!==e&&void 0!==e&&e.subdistrict?e.subdistrict:1,showbiz:null===e||void 0===e||!e.showbiz||e.showbiz,extensions:null!==e&&void 0!==e&&e.extensions?e.extensions:"base"},i=null!==e&&void 0!==e&&e.keyword?e.keyword:"中国";return new Promise((function(e,a){t.plugin("AMap.DistrictSearch",(function(){var o=new t.DistrictSearch(n);o.search(i,(function(t,n){"complete"==t?e(n.districtList[0]["districtList"]):a("Error")}))}))}))}},{key:"placeSearchType",get:function(){var e="汽车服务|汽车销售|汽车维修|摩托车服务|餐饮服务|购物服务|生活服务|体育休闲服务|医疗保健服务|住宿服务|风景名胜|商务住宅|政府机构及社会团体|科教文化服务|交通设施服务|金融保险服务|公司企业|道路附属设施|地名地址信息|公共设施";return e.split("|")}},{key:"plugin",get:function(){var e=[{label:"输入提示，根据输入关键字提示匹配信息",value:"Autocomplete"},{label:"地点搜索服务插件，提供某一特定地区的位置查询服务",value:"PlaceSearch"},{label:"行政区查询服务，提供行政区相关信息",value:"DistrictSearch"},{label:"驾车路线规划服务",value:"Driving"},{label:"公交换乘服务",value:"Transfer"},{label:"骑行路线规划服务",value:"Riding"},{label:"步行路线规划服务",value:"Walking"}],t=e.map((function(e){return"AMap.".concat(e.value)}));return t.toString()}},{key:"placeSearch",value:function(e){var t=this.AMap,n={city:null!==e&&void 0!==e&&e.city&&""!=e.city?e.city:"全国",citylimit:!(null===e||void 0===e||!e.citylimit)&&e.citylimit,children:null!==e&&void 0!==e&&e.children?e.children:0,type:null!==e&&void 0!==e&&e.type?e.type:"餐饮服务|商务住宅|生活服务",lang:null!==e&&void 0!==e&&e.lang?e.lang:"zh_cn",pageSize:null!==e&&void 0!==e&&e.pageSize?e.pageSize:10,pageIndex:null!==e&&void 0!==e&&e.pageIndex?e.pageIndex:1,extensions:null!==e&&void 0!==e&&e.extensions?e.extensions:"base",map:null!==e&&void 0!==e&&e.map?e.map:void 0,panel:null!==e&&void 0!==e&&e.panel?e.panel:"",showCover:null===e||void 0===e||!e.showCover||e.showCover,renderStyle:null!==e&&void 0!==e&&e.renderStyle?e.renderStyle:"default",autoFitView:null===e||void 0===e||!e.autoFitView||e.autoFitView},i=null!==e&&void 0!==e&&e.searchKeyword?e.searchKeyword:"",a=new t.PlaceSearch(n);return new Promise((function(e,n){t.plugin("AMap.PlaceSearch",(function(){a.search(i,(function(t,i){"complete"==t?e(i.poiList):n("Error")}))}))}))}},{key:"getDetails",value:function(e){var t=this.AMap,n=new t.PlaceSearch({extensions:"all"});return new Promise((function(t,i){n.getDetails(e,(function(e,n){"complete"===e&&"OK"===n.info?t(n):i("Error")}))}))}},{key:"AutoComplete",value:function(e){var t=this.AMap,n={type:null!==e&&void 0!==e&&e.type?e.type:"",city:null!==e&&void 0!==e&&e.city&&""!=e.city?e.city:"全国",datatype:null!==e&&void 0!==e&&e.datatype?e.datatype:"all",citylimit:!(null===e||void 0===e||!e.citylimit)&&e.citylimit,input:null!==e&&void 0!==e&&e.input?e.input:void 0,output:null!==e&&void 0!==e&&e.output?e.output:void 0,outPutDirAuto:null===e||void 0===e||!e.outPutDirAuto||e.outPutDirAuto};return new Promise((function(e,i){t.plugin("AMap.AutoComplete",(function(){var i=new t.AutoComplete(n);e(i)}))}))}},{key:"Driving",value:function(e){var t=this.AMap,n={map:null!==e&&void 0!==e&&e.map?e.map:void 0,policy:null!==e&&void 0!==e&&e.policy?e.policy:0,extensions:null!==e&&void 0!==e&&e.extensions?e.extensions:"base",ferry:null!==e&&void 0!==e&&e.ferry?e.ferry:0,panel:null!==e&&void 0!==e&&e.panel?e.panel:void 0,hideMarkers:!(null===e||void 0===e||!e.hideMarkers)&&e.hideMarkers,showTraffic:null===e||void 0===e||!e.showTraffic||e.showTraffic,province:null!==e&&void 0!==e&&e.province?e.province:void 0,number:null!==e&&void 0!==e&&e.number?e.number:void 0,isOutline:null!==e&&void 0!==e&&e.isOutline?e.isOutline:void 0,outlineColor:null!==e&&void 0!==e&&e.outlineColor?e.outlineColor:void 0,autoFitView:null!==e&&void 0!==e&&e.autoFitView?e.autoFitView:void 0};return new Promise((function(i,a){t.plugin("AMap.Driving",(function(){var o=new t.Driving(n);o.search(e.start,e.end,(function(e,t){"complete"==e?i(t):a("Error")}))}))}))}},{key:"Transfer",value:function(e){var t=this.AMap,n={map:null!==e&&void 0!==e&&e.map?e.map:void 0,city:null!==e&&void 0!==e&&e.city?e.city:"",policy:null!==e&&void 0!==e&&e.policy?e.policy:0,nightflag:!(null===e||void 0===e||!e.nightflag)&&e.nightflag,extensions:null!==e&&void 0!==e&&e.extensions?e.extensions:"base",panel:null!==e&&void 0!==e&&e.panel?e.panel:"",hideMarkers:!(null===e||void 0===e||!e.hideMarkers)&&e.hideMarkers,isOutline:null!==e&&void 0!==e&&e.isOutline?e.isOutline:void 0,outlineColor:null!==e&&void 0!==e&&e.outlineColor?e.outlineColor:void 0,autoFitView:null!==e&&void 0!==e&&e.autoFitView?e.autoFitView:void 0};return new Promise((function(i,a){t.plugin("AMap.Transfer",(function(){var o=new t.Transfer(n);o.search(e.start,e.end,(function(e,t){"complete"==e?i(t):a("Error")}))}))}))}},{key:"Riding",value:function(e){var t=this.AMap,n={map:null!==e&&void 0!==e&&e.map?e.map:void 0,policy:null!==e&&void 0!==e&&e.policy?e.policy:0,panel:null!==e&&void 0!==e&&e.panel?e.panel:"",hideMarkers:!(null===e||void 0===e||!e.hideMarkers)&&e.hideMarkers,isOutline:null!==e&&void 0!==e&&e.isOutline?e.isOutline:void 0,outlineColor:null!==e&&void 0!==e&&e.outlineColor?e.outlineColor:void 0,autoFitView:null!==e&&void 0!==e&&e.autoFitView?e.autoFitView:void 0};return new Promise((function(i,a){t.plugin("AMap.Riding",(function(){var o=new t.Riding(n);o.search(e.start,e.end,(function(e,t){"complete"==e?i(t):a("Error")}))}))}))}},{key:"Walking",value:function(e){var t=this.AMap,n={map:null!==e&&void 0!==e&&e.map?e.map:void 0,panel:null!==e&&void 0!==e&&e.panel?e.panel:"",hideMarkers:!(null===e||void 0===e||!e.hideMarkers)&&e.hideMarkers,isOutline:null!==e&&void 0!==e&&e.isOutline?e.isOutline:void 0,outlineColor:null!==e&&void 0!==e&&e.outlineColor?e.outlineColor:void 0,autoFitView:null!==e&&void 0!==e&&e.autoFitView?e.autoFitView:void 0};return new Promise((function(i,a){t.plugin("AMap.Walking",(function(){var o=new t.Walking(n);o.search(e.start,e.end,(function(e,t){"complete"==e?i(t):a("Error")}))}))}))}}]),e}()),m=p,h={props:{show:{type:Boolean,default:function(){return!1}},option:{type:Object,default:function(){return{}}}},data:function(){return{drawer:!1,_GaodeMap:null,_Utils:null,loading:!1,panelTypeArr:[{label:"兴趣点",value:"1"},{label:"路线规划与导航",value:"2"}],panelType:"1",range:"city",cityOptions:[],city:["210000","210100"],placeSearchType:[],searchType:["餐饮服务","商务住宅","生活服务"],polymerization:!1,keyword:"",pageIndex:1,pageSize:20,total:0,poisList:[],startPosition:"",endPosition:"",startPositionResult:{},endPositionResult:{},navigationTypeArr:[{label:"驾车",value:"1"},{label:"公交",value:"2"},{label:"骑行",value:"3"},{label:"步行",value:"4"}],navigationType:"",routeLocationArr:[]}},watch:{show:{handler:function(e,t){this.drawer=e,e&&this.initAutoComplete()},deep:!0,immediate:!0}},mounted:function(){var e=this;window._AMapSecurityConfig={securityJsCode:"2a0ce2005352672661417093c485a056"},this._Utils=new c["a"],this._Utils.loadJs("https://webapi.amap.com/maps?v=2.0&key=".concat("cb250acd7ee0e7b2049cb93747ae3d44","&plugin=").concat((new m).plugin),{append:"body",defer:!0}).then((function(){e._GaodeMap=new m(AMap),e.$nextTick((function(){e._GaodeMap.districtList({subdistrict:2}).then((function(t){e.cityOptions=t})),e.placeSearchType=e._GaodeMap.placeSearchType}))}))},methods:{navigationTypeChange:function(e){var t=this;document.getElementById("panel").innerHTML="";var n=[this.startPositionResult.poi.location.lng,this.startPositionResult.poi.location.lat],i=[this.endPositionResult.poi.location.lng,this.endPositionResult.poi.location.lat];"1"==e&&this._GaodeMap.Driving({panel:"panel",start:n,end:i}).then((function(e){if(0!=e.routes.length){for(var n=[],i=e.routes[0].steps,a=i.length,o=0;o<a;o++){var l=i[o];n.push([l.start_location.lng,l.start_location.lat]),a-1==o&&n.push([l.end_location.lng,l.end_location.lat])}t.$emit("load",{type:"navigation",style:"driving",data:n})}})),"2"==e&&this._GaodeMap.Transfer({panel:"panel",start:n,end:i,city:"沈阳市"}).then((function(e){})),"3"==e&&this._GaodeMap.Riding({panel:"panel",start:n,end:i}).then((function(e){if(0!=e.routes.length){for(var n=[],i=e.routes[0].rides,a=i.length,o=0;o<a;o++){var l=i[o];n.push([l.start_location.lng,l.start_location.lat]),a-1==o&&n.push([l.end_location.lng,l.end_location.lat])}t.$emit("load",{type:"navigation",style:"riding",data:n})}})),"4"==e&&this._GaodeMap.Walking({panel:"panel",start:n,end:i}).then((function(e){if(0!=e.routes.length){for(var n=[],i=e.routes[0].steps,a=i.length,o=0;o<a;o++){var l=i[o];n.push([l.start_location.lng,l.start_location.lat]),a-1==o&&n.push([l.end_location.lng,l.end_location.lat])}t.$emit("load",{type:"navigation",style:"walking",data:n})}}))},tabClick:function(e){"2"==e.name&&this.initAutoComplete()},initAutoComplete:function(){var e=this;setTimeout((function(){e._GaodeMap.AutoComplete({input:"startPosition"}).then((function(t){t.on("select",(function(t){t.poi.location?e.startPositionResult=t:e.$notify({title:"警告",message:"输入的地址有误，请重新输入",type:"warning"})}))})),e._GaodeMap.AutoComplete({input:"endPosition"}).then((function(t){t.on("select",(function(t){t.poi.location?e.endPositionResult=t:e.$notify({title:"警告",message:"输入的地址有误，请重新输入",type:"warning"})}))}))}),500)},poisClick:function(e){this.$emit("poisClick",e)},search:function(){var e=this;if(""!=this.keyword)if("city"!=this.range||0!=this.city.length){var t={pageSize:this.pageSize,pageIndex:this.pageIndex,searchKeyword:this.keyword,extensions:"all"};"city"==this.range&&(t.city=this.city[1]||""),0!=this.searchType.length&&(t.type=this.searchType.join("|")),this.loading=!0,this._GaodeMap.placeSearch(t).then((function(t){e.total=t.count,e.poisList=t.pois,e.$nextTick((function(){e.$refs.poisList.scrollTop=0})),e.loading=!1,e.$emit("load",{type:"pois",polymerization:e.polymerization,data:e.poisList})})).catch((function(t){e.$notify.error({title:"错误",message:"请重新搜索"})}))}else this.$message({message:"请选择城市",type:"warning"})},currentPaginationChange:function(e){this.pageIndex=e,this.search()},handleClose:function(){this.$emit("close")}}},v=h,g=(n("aaa7"),n("cba8")),f=Object(g["a"])(v,r,s,!1,null,"ea37cd90",null),y=f.exports,b=n("dd8c"),w=n("9e48"),C=n("f4bf"),_=function(e){var t=function(){return"czm_material czm_getMaterial(czm_materialInput materialInput)\n            {\n                 czm_material material = czm_getDefaultMaterial(materialInput);\n                 vec2 st = materialInput.st;\n                 vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n                 material.alpha = colorImage.a * color.a;\n                 material.diffuse = (colorImage.rgb+color.rgb)/2.0;\n                 return material;\n             }"};return{cesiumName:"Material_TrailLineMaterialProperty",image:"/cesium-template/Vue/Entity/wall/flow.png",color:e.Color.RED.withAlpha(.5),duration:15e3,uniforms:{color:new e.Color(1,1,1,1),image:e.Material.DefaultImageId,time:0,constantSpeed:300,depthFailMaterial:!0},source:t()}},P=n("4cef"),M=n("7adc"),A=n.n(M),T=[{codeLanguage:"VUE",relyOn:[{label:"gcoord（npm）",url:"https://www.npmjs.com/package/gcoord",externalLinks:!0},{label:"geojson（npm）",url:"https://www.npmjs.com/package/geojson",externalLinks:!0},{label:"Utils.js",url:"cesium/Utils.js"},{label:"Entity.js",url:"cesium/Entity.js"},{label:"Canvas.js",url:"cesium/Canvas.js"},{label:"Gaode/index.js",url:"cesium/Map/Gaode/index.js"},{label:"Materials/index.js",url:"cesium/Materials/index.js"},{label:"TrailLineMaterialProperty.js",url:"Vue/Maps/Gaode/PoiQuery/material/TrailLineMaterialProperty.js"},{label:"POI-panel.scss",url:"Vue/Maps/Gaode/PoiQuery/POI-panel.scss"},{label:"POI-panel.vue",url:"Vue/Maps/Gaode/PoiQuery/POI-panel.vue"},{label:"position.png",url:"Vue/Maps/Gaode/PoiQuery/position.png"},{label:"position-active.png",url:"Vue/Maps/Gaode/PoiQuery/position-active.png"},{label:"cluster_1.png",url:"Vue/Maps/Gaode/PoiQuery/cluster_1.png"},{label:"cluster_2.png",url:"Vue/Maps/Gaode/PoiQuery/cluster_2.png"},{label:"cluster_3.png",url:"Vue/Maps/Gaode/PoiQuery/cluster_3.png"},{label:"cluster_4.png",url:"Vue/Maps/Gaode/PoiQuery/cluster_4.png"}],code:[{codeLanguage:"html",content:'<template>\n                    <div class="container">\n                      <div id="cesiumContainer"></div>\n                      <el-button\n                        type="primary"\n                        class="tools"\n                        icon="el-icon-s-tools"\n                        circle\n                        @click="poiPanelShow = !poiPanelShow"\n                      ></el-button>\n                      <poi-Panel\n                        :show="poiPanelShow"\n                        @close="poiPanelShow = false"\n                        @load="load"\n                        @poisClick="poisClick"\n                      />\n                    </div>\n                  </template>'},{codeLanguage:"js",content:'import poiPanel from "./module/POI-panel.vue";\n                  import Canvas from "@/common/cesium/Canvas.js";\n                  import Entity from "@/common/cesium/Entity.js";\n                  import gcoord from "gcoord";\n                  import TrailLineMaterialProperty from "./module/material/TrailLineMaterialProperty"; //流动\n                  import Material from "@/common/cesium/Materials/index.js";\n                  import GeoJSON from "geojson";\n                  export default {\n                    name: "PoiQuery",\n                    components: { poiPanel },\n                    data() {\n                      return {\n                        poiPanelShow: false,\n                  \n                        viewer: null,\n                        _Entity: null,\n                        _Canvas: null,\n                  \n                        EntityArr: [],\n                      };\n                    },\n                    mounted() {\n                      this.init();\n                    },\n                    methods: {\n                      init() {\n                        const Cesium = this.cesium;\n                        Cesium.Ion.defaultAccessToken = process.env.VUE_APP_TOKEN;\n                        this.viewer = new Cesium.Viewer("cesiumContainer", {\n                          imageryProvider: new Cesium.ArcGisMapServerImageryProvider({\n                            url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",\n                          }),\n                          terrainProvider: new Cesium.CesiumTerrainProvider({\n                            //加载火星在线地形\n                            url: "http://data.marsgis.cn/terrain",\n                          }),\n                          shouldAnimate: true,\n                          infoBox: false,\n                          selectionIndicator: false,\n                        });\n                        //地形侦测\n                        this.viewer.scene.globe.depthTestAgainstTerrain = false;\n                  \n                        this._Entity = new Entity(Cesium, this.viewer);\n                        this._Material = new Material(Cesium, this.viewer);\n                        this._Canvas = new Canvas(Cesium, this.viewer);\n                      },\n                      /**\n                       * 兴趣点触发\n                       * @param {*} e\n                       */\n                      poisClick(e) {\n                        //坐标系转换\n                        const result = gcoord.transform(\n                          [e.location.lng, e.location.lat], // 经纬度坐标\n                          gcoord.AMap, // 当前坐标系\n                          gcoord.WGS84 // 目标坐标系\n                        );\n                        this.setCamera({\n                          location: result,\n                        });\n                      },\n                      /**\n                       * 设置相机位置\n                       * @param {*} e\n                       */\n                      setCamera(e) {\n                        const Cesium = this.cesium;\n                        this.viewer.camera.flyTo({\n                          destination: Cesium.Cartesian3.fromDegrees(\n                            e.location[0],\n                            e.location[1],\n                            3000\n                          ),\n                        });\n                      },\n                      /**\n                       * 操作面板加载回调\n                       */\n                      load(e) {\n                        this.viewer.entities.removeAll();\n                        if (e.type == "pois") {\n                          this.setPointPosition(e).then((res) => {\n                            this.EntityArr = res;\n                            this.viewer.flyTo(res);\n                          });\n                        }\n                        if (e.type == "navigation") {\n                          this.setDrawRoute(e.data, e.style);\n                        }\n                      },\n                      /**\n                       * 绘制路线\n                       * @param {*} arr\n                       */\n                      setDrawRoute(arr, style) {\n                        const Cesium = this.cesium;\n                        let color = "";\n                        if (style == "driving") {\n                          color = "#409EFF";\n                        }\n                        if (style == "riding") {\n                          color = "#67C23A";\n                        }\n                        if (style == "walking") {\n                          color = "#E6A23C";\n                        }\n                  \n                        const arrData = [];\n                        arr.map((item) => {\n                          const result = gcoord.transform(\n                            [item[0], item[1]], // 经纬度坐标\n                            gcoord.AMap, // 当前坐标系\n                            gcoord.WGS84 // 目标坐标系\n                          );\n                          arrData.push(result[0], result[1]);\n                        });\n                  \n                        this._Material.create(TrailLineMaterialProperty(Cesium));\n                  \n                        const Route = this._Entity.createPolyline({\n                          positions: Cesium.Cartesian3.fromDegreesArray(arrData),\n                          // clampToGround: true,\n                          // material: new Cesium.Color.fromCssColorString(color),\n                          material: new Cesium.Material_TrailLineMaterialProperty(),\n                          arcType: Cesium.ArcType.GEODESIC,\n                          width: 10,\n                        });\n                        this.viewer.flyTo(Route);\n                      },\n                      /**\n                       * 设置标点\n                       */\n                      async setPointPosition(data) {\n                        const Cesium = this.cesium;\n                        \n                        //实体数据\n                        const EntityArr = [];\n                        //是否聚合\n                        const polymerization = data.polymerization;\n                        //json数据\n                        const arr = data.data;\n                        //geojson 数据\n                        return await new Promise((resolve, reject) => {\n                          if (polymerization) {\n                            const _getJson = GeoJSON.parse(arr, {\n                              Point: ["location.lat", "location.lng"],\n                            });\n                            new Cesium.GeoJsonDataSource().load(_getJson).then((dataSource) => {\n                              this.viewer.dataSources.add(dataSource);\n                              // 设置聚合参数\n                              dataSource.clustering.enabled = true;\n                              dataSource.clustering.pixelRange = 60;\n                              dataSource.clustering.minimumClusterSize = 2;\n                  \n                              // foreach用于调用数组的每个元素，并将元素传递给回调函数。\n                              for (let i = 0; i < dataSource.entities.values.length; i++) {\n                                const entity = dataSource.entities.values[i];\n                                // 将点拉伸一定高度，防止被地形压盖\n                                entity.position._value.z += 50.0;\n                                // 使用大小为64*64的icon，缩小展示poi\n                                entity.billboard = {\n                                  image:\n                                    process.env.VUE_APP_PUBLIC_URL +\n                                    "/Vue/Maps/Gaode/PoiQuery/position.png",\n                                  width: 16,\n                                  height: 22,\n                                };\n                                //⽂字标签\n                                entity.label = {\n                                  text: entity.properties.name._value,\n                                  font: "500 30px Helvetica", // 15pt monospace\n                                  scale: 0.5,\n                                  style: Cesium.LabelStyle.FILL_AND_OUTLINE,\n                                  fillColor: Cesium.Color.WHITE,\n                                  pixelOffset: new Cesium.Cartesian2(-8, -50), //偏移量\n                                  showBackground: false,\n                                  heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\n                                  distanceDisplayCondition: new Cesium.DistanceDisplayCondition(\n                                    0.0,\n                                    20000.0\n                                  ),\n                                };\n                                EntityArr.push(entity);\n                              }\n                  \n                              // 添加监听函数\n                              dataSource.clustering.clusterEvent.addEventListener(\n                                (clusteredEntities, cluster) => {\n                                  // 关闭自带的显示聚合数量的标签\n                                  cluster.label.show = false;\n                                  cluster.billboard.show = true;\n                                  cluster.billboard.verticalOrigin = Cesium.VerticalOrigin.BOTTOM;\n                  \n                                  // 根据聚合数量的多少设置不同层级的图片以及大小\n                                  if (clusteredEntities.length >= 20) {\n                                    cluster.billboard.image = this._Canvas.combineIconAndLabel({\n                                      url:\n                                        process.env.VUE_APP_PUBLIC_URL +\n                                        "/Vue/Maps/Gaode/PoiQuery/cluster_4.png",\n                                      label: clusteredEntities.length,\n                                      size: 72,\n                                    });\n                                    cluster.billboard.width = 72;\n                                    cluster.billboard.height = 72;\n                                  } else if (clusteredEntities.length >= 12) {\n                                    cluster.billboard.image = this._Canvas.combineIconAndLabel({\n                                      url:\n                                        process.env.VUE_APP_PUBLIC_URL +\n                                        "/Vue/Maps/Gaode/PoiQuery/cluster_3.png",\n                                      label: clusteredEntities.length,\n                                      size: 56,\n                                    });\n                                    cluster.billboard.width = 56;\n                                    cluster.billboard.height = 56;\n                                  } else if (clusteredEntities.length >= 8) {\n                                    cluster.billboard.image = this._Canvas.combineIconAndLabel({\n                                      url:\n                                        process.env.VUE_APP_PUBLIC_URL +\n                                        "/Vue/Maps/Gaode/PoiQuery/cluster_2.png",\n                                      label: clusteredEntities.length,\n                                      size: 48,\n                                    });\n                                    cluster.billboard.width = 48;\n                                    cluster.billboard.height = 48;\n                                  } else {\n                                    cluster.billboard.image = this._Canvas.combineIconAndLabel({\n                                      url:\n                                        process.env.VUE_APP_PUBLIC_URL +\n                                        "/Vue/Maps/Gaode/PoiQuery/cluster_1.png",\n                                      label: clusteredEntities.length,\n                                      size: 40,\n                                    });\n                                    cluster.billboard.width = 40;\n                                    cluster.billboard.height = 40;\n                                  }\n                                }\n                              );\n                            });\n                            setTimeout(()=>{\n                              resolve(EntityArr)\n                            },1000)\n                            // return await EntityArr;\n                          } else {\n                            for (let i = 0; i < arr.length; i++) {\n                              const item = arr[i];\n                              //坐标系转换\n                              const result = gcoord.transform(\n                                [item.location.lng, item.location.lat], // 经纬度坐标\n                                gcoord.AMap, // 当前坐标系\n                                gcoord.WGS84 // 目标坐标系\n                              );\n                              const _Entity_ = this._Entity.createBillboard({\n                                id: item.id,\n                                name: item.name,\n                                position: Cesium.Cartesian3.fromDegrees(result[0], result[1]),\n                                common: {\n                                  label: {\n                                    //⽂字标签\n                                    text: item.name,\n                                    font: "500 30px Helvetica", // 15pt monospace\n                                    scale: 0.5,\n                                    style: Cesium.LabelStyle.FILL_AND_OUTLINE,\n                                    fillColor: Cesium.Color.WHITE,\n                                    pixelOffset: new Cesium.Cartesian2(-8, -50), //偏移量\n                                    showBackground: false,\n                                    heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\n                                    distanceDisplayCondition: new Cesium.DistanceDisplayCondition(\n                                      0.0,\n                                      20000.0\n                                    ),\n                                  },\n                                },\n                                image:\n                                  process.env.VUE_APP_PUBLIC_URL +\n                                  "/Vue/Maps/Gaode/PoiQuery/position.png",\n                                verticalOrigin: Cesium.VerticalOrigin.BOTTOM,\n                                heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\n                                width: 16,\n                                height: 22,\n                              });\n                              EntityArr.push(_Entity_);\n                            }\n                            setTimeout(()=>{\n                              resolve(EntityArr)\n                            },1000)\n                            // return await EntityArr;\n                          }\n                        });\n                      },\n                    },\n                  };'},{codeLanguage:"css",content:".container {\n                    width: 100%;\n                    height: 100%;\n                    #cesiumContainer {\n                      width: 100%;\n                      height: 100%;\n                    }\n                    .tools {\n                      position: fixed;\n                      bottom: 40px;\n                      right: 20px;\n                    }\n                  }"}]}],E={name:"PoiQuery",components:{poiPanel:y},data:function(){return{poiPanelShow:!1,viewer:null,_Entity:null,_Canvas:null,EntityArr:[]}},created:function(){this.$store.dispatch("highlight/set_code",T)},mounted:function(){this.init()},methods:{init:function(){var e=this.cesium;e.Ion.defaultAccessToken=Object({NODE_ENV:"production",VUE_APP_BASE_API:"/prod-api",VUE_APP_GAODE_KEY_WEB_SERVICE:"181ced609de9d446207b55e549bafcb6",VUE_APP_GAODE_KEY_WEB_TERMINAL:"cb250acd7ee0e7b2049cb93747ae3d44",VUE_APP_PUBLIC_URL:"/cesium-template",VUE_APP_SECURITY_JS_CODE:"2a0ce2005352672661417093c485a056",BASE_URL:""}).VUE_APP_TOKEN,this.viewer=new e.Viewer("cesiumContainer",{imageryProvider:new e.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),terrainProvider:new e.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"}),shouldAnimate:!0,infoBox:!1,selectionIndicator:!1}),this.viewer.scene.globe.depthTestAgainstTerrain=!1,this._Entity=new w["a"](e,this.viewer),this._Material=new P["a"](e,this.viewer),this._Canvas=new b["a"](e,this.viewer)},poisClick:function(e){var t=C["a"].transform([e.location.lng,e.location.lat],C["a"].AMap,C["a"].WGS84);this.setCamera({location:t})},setCamera:function(e){var t=this.cesium;this.viewer.camera.flyTo({destination:t.Cartesian3.fromDegrees(e.location[0],e.location[1],3e3)})},load:function(e){var t=this;this.viewer.entities.removeAll(),"pois"==e.type&&this.setPointPosition(e).then((function(e){t.EntityArr=e,t.viewer.flyTo(e)})),"navigation"==e.type&&this.setDrawRoute(e.data,e.style)},setDrawRoute:function(e,t){var n=this.cesium;var i=[];e.map((function(e){var t=C["a"].transform([e[0],e[1]],C["a"].AMap,C["a"].WGS84);i.push(t[0],t[1])})),this._Material.create(_(n));var a=this._Entity.createPolyline({positions:n.Cartesian3.fromDegreesArray(i),material:new n.Material_TrailLineMaterialProperty,arcType:n.ArcType.GEODESIC,width:10});this.viewer.flyTo(a)},setPointPosition:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function n(){var i,a,l,r;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.cesium,a=[],l=e.polymerization,r=e.data,n.next=6,new Promise((function(e,n){if(l){var o=A.a.parse(r,{Point:["location.lat","location.lng"]});(new i.GeoJsonDataSource).load(o).then((function(e){t.viewer.dataSources.add(e),e.clustering.enabled=!0,e.clustering.pixelRange=60,e.clustering.minimumClusterSize=2;for(var n=0;n<e.entities.values.length;n++){var o=e.entities.values[n];o.position._value.z+=50,o.billboard={image:"/cesium-template/Vue/Maps/Gaode/PoiQuery/position.png",width:16,height:22},o.label={text:o.properties.name._value,font:"500 30px Helvetica",scale:.5,style:i.LabelStyle.FILL_AND_OUTLINE,fillColor:i.Color.WHITE,pixelOffset:new i.Cartesian2(-8,-50),showBackground:!1,heightReference:i.HeightReference.CLAMP_TO_GROUND,distanceDisplayCondition:new i.DistanceDisplayCondition(0,2e4)},a.push(o)}e.clustering.clusterEvent.addEventListener((function(e,n){n.label.show=!1,n.billboard.show=!0,n.billboard.verticalOrigin=i.VerticalOrigin.BOTTOM,e.length>=20?(n.billboard.image=t._Canvas.combineIconAndLabel({url:"/cesium-template/Vue/Maps/Gaode/PoiQuery/cluster_4.png",label:e.length,size:72}),n.billboard.width=72,n.billboard.height=72):e.length>=12?(n.billboard.image=t._Canvas.combineIconAndLabel({url:"/cesium-template/Vue/Maps/Gaode/PoiQuery/cluster_3.png",label:e.length,size:56}),n.billboard.width=56,n.billboard.height=56):e.length>=8?(n.billboard.image=t._Canvas.combineIconAndLabel({url:"/cesium-template/Vue/Maps/Gaode/PoiQuery/cluster_2.png",label:e.length,size:48}),n.billboard.width=48,n.billboard.height=48):(n.billboard.image=t._Canvas.combineIconAndLabel({url:"/cesium-template/Vue/Maps/Gaode/PoiQuery/cluster_1.png",label:e.length,size:40}),n.billboard.width=40,n.billboard.height=40)}))})),setTimeout((function(){e(a)}),1e3)}else{for(var s=0;s<r.length;s++){var c=r[s],u=C["a"].transform([c.location.lng,c.location.lat],C["a"].AMap,C["a"].WGS84),d=t._Entity.createBillboard({id:c.id,name:c.name,position:i.Cartesian3.fromDegrees(u[0],u[1]),common:{label:{text:c.name,font:"500 30px Helvetica",scale:.5,style:i.LabelStyle.FILL_AND_OUTLINE,fillColor:i.Color.WHITE,pixelOffset:new i.Cartesian2(-8,-50),showBackground:!1,heightReference:i.HeightReference.CLAMP_TO_GROUND,distanceDisplayCondition:new i.DistanceDisplayCondition(0,2e4)}},image:"/cesium-template/Vue/Maps/Gaode/PoiQuery/position.png",verticalOrigin:i.VerticalOrigin.BOTTOM,heightReference:i.HeightReference.CLAMP_TO_GROUND,width:16,height:22});a.push(d)}setTimeout((function(){e(a)}),1e3)}}));case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))()}}},k=E,O=(n("c20c"),Object(g["a"])(k,i,a,!1,null,"26fdea99",null));t["default"]=O.exports},aaa7:function(e,t,n){"use strict";n("21b7")},c20c:function(e,t,n){"use strict";n("50ff")},c407:function(e,t,n){"use strict";var i=n("c15f"),a=n("a35b"),o=(n("a256"),function(){function e(t,n){Object(i["a"])(this,e),this.Cesium=t,this.viewer=n}return Object(a["a"])(e,[{key:"getRandomColor",get:function(){for(var e="#",t=["a","b","c","d","e","f","0","1","2","3","4","5","6","7","8","9"],n=0;n<6;n++){var i=Math.floor(Math.random()*t.length+1)-1;e+=t[i]}return e}},{key:"operationDom",value:function(e,t,n){if("append"===e&&document.getElementById(t).appendChild(n),"remove"===e&&document.getElementById(t).remove(),"has"===e)return document.getElementById(t)}},{key:"debounce",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){var a=this,o=arguments;if(t&&clearTimeout(t),i){var l=!t;t=setTimeout((function(){t=null}),n),l&&e.apply(a,o)}else t=setTimeout((function(){e.apply}),n)}}},{key:"throttle",value:function(e,t,n){var i,a=0;return function(){var o=this,l=arguments;if(1===n){var r=Date.now();r-a>t&&(e.apply(o,l),a=r)}else 2===n&&(i||(i=setTimeout((function(){i=null,e.apply(o,l)}),t)))}}},{key:"createScript",value:function(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"loadJs",value:function(e,t){return new Promise((function(n,i){var a=document.createElement("script");a.type="text/javascript",null!==t&&void 0!==t&&t.async&&t.async&&(a.async="async"),null!==t&&void 0!==t&&t.defer&&t.defer&&(a.defer="defer");var o="body";null!==t&&void 0!==t&&t.append&&t.append&&("body"==t.append||"head"==t.append)&&(o=t.append),a.src=e,document[o].appendChild(a),a.onload=function(){n()},a.onerror=function(){i()}}))}}]),e}());t["a"]=o},dd8c:function(e,t,n){"use strict";var i=n("d941"),a=n("c3ae"),o=n("c15f"),l=n("a35b"),r=(n("a256"),function(){function e(t,n){Object(o["a"])(this,e),this.Cesium=t,this.viewer=n}return Object(l["a"])(e,[{key:"drawText",value:function(e){var t=e.text,n=document.createElement("canvas"),i=(t+"").length*e.fontSize;n.width=i,n.height=e.fontSize;var a=n.getContext("2d");return a.fillStyle=e.color,a.font="bold "+e.fontSize+"px 微软雅黑",a.textBaseline="hanging",a.fillText(t,0,0),n}},{key:"drawImageText",value:function(){var e=Object(a["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var i,a=document.createElement("img");a.src=t.src,a.onload=function(){i=document.createElement("canvas"),i.height=t.height,i.width=t.width;var n=i.getContext("2d");n.clearRect(0,0,i.width,i.height),n.drawImage(a,0,0),n.font="30px bold 楷体",n.fillStyle="#fff";var o="阳性："+t.data.num;n.fillText(o,(i.width-30*o.length)/2,(i.height+30)/2),e(i)}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"combineIconAndLabel",value:function(e){var t=e.url,n=e.label,i=e.size,a=this.Cesium,o=document.createElement("canvas");o.width=i,o.height=i;var l=o.getContext("2d"),r=new a.Resource.fetchImage(t).then((function(e){try{l.drawImage(e,0,0)}catch(t){console.log(t)}return l.fillStyle=a.Color.WHITE.toCssColorString(),l.font="bold 20px Microsoft YaHei",l.textAlign="center",l.textBaseline="middle",l.fillText(n,i/2,i/2),o}));return r}}]),e}());t["a"]=r}}]);