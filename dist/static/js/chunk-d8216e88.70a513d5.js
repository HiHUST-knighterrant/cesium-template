(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d8216e88"],{"4bb1":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a567");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"4cef":function(e,t,n){"use strict";var i=n("4bb1"),a=n("e143"),r=function(){function e(t,n){Object(i["a"])(this,e),this.Cesium=t,this.viewer=n}return Object(a["a"])(e,[{key:"create",value:function(e){var t=this.Cesium,n=this.viewer,i=null!==e&&void 0!==e&&e.cesiumName?e.cesiumName:"",a=null!==e&&void 0!==e&&e.source?e.source:"",r=null!==e&&void 0!==e&&e.uniforms?e.uniforms:"";function l(){this._definitionChanged=new t.Event,this._color=void 0,this._colorSubscription=void 0,this.color=null!==e&&void 0!==e&&e.color?e.color:t.Color.BLUE,this.duration=null!==e&&void 0!==e&&e.duration?e.duration:1e3,this.image=null!==e&&void 0!==e&&e.image?e.image:"",this._time=(new Date).getTime()}Object.defineProperties(l.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:t.createPropertyDescriptor("color")});var o="Material".concat(parseInt(1e3*Math.random()));return l.prototype.getType=function(e){return o},l.prototype.getValue=function(e,i){return t.defined(i)||(i={}),i.color=t.Property.getValueOrClonedDefault(this._color,e,t.Color.WHITE,i.color),i.image=this.image,this.duration&&(i.time=((new Date).getTime()-this._time)%this.duration/this.duration),n.scene.requestRender(),i},l.prototype.equals=function(e){return this===e||e instanceof l&&t.Property.equals(this._color,e._color)},t.Material._materialCache.addMaterial(o,{fabric:{type:o,uniforms:r,source:a},translucent:function(e){return!0}}),t[i]=l,l}}]),e}();t["a"]=r},"78be":function(e,t,n){var i=n("46a7"),a=n("bc35"),r=n("5386");i({target:"Array",proto:!0},{fill:a}),r("fill")},"7d42":function(e,t,n){},"88c8":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{attrs:{id:"cesiumContainer"}}),n("div",{staticClass:"operation-panel"},[n("el-select",{attrs:{size:"mini",placeholder:"请选择墙体类型"},model:{value:e.wallType,callback:function(t){e.wallType=t},expression:"wallType"}},e._l(e.wallTypeArr,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-button",{staticClass:"startButton",attrs:{size:"mini",disabled:""==e.wallType,type:"primary",plain:""},on:{click:e.startDraw}},[e._v("开始绘制")])],1)])},a=[],r=(n("decf"),n("eb3b"),n("78be"),n("4cef")),l=n("9e48"),o=[{label:"流动墙",value:"1",position:[123.4338589341694,41.811889939097895,123.43329581924921,41.81177873630029,123.43297281881931,41.811434437097255,123.43295567370998,41.81102812337492,123.43320435913063,41.81071804352293,123.43357881081174,41.81055765802799,123.43411333122562,41.81054910409206,123.43461355350443,41.810780058939656,123.43479363918155,41.81118637120609,123.4346707315803,41.811541361879385,123.43434772954672,41.811797982861705,123.4338589341694,41.811889939097895],title:"惠工广场"},{label:"波纹墙",value:"2",position:[123.38624525883692,41.794068393526416,123.38687089890857,41.79395971222164,123.38747418262378,41.7946536433207,123.38875897739584,41.7940600412453,123.3890159272599,41.79370053758991,123.38833443306693,41.79279761067365,123.38875895717108,41.79253843546213,123.38815568203603,41.79180272016025,123.38761944484679,41.7918863236855,123.38630123240169,41.79013897251926,123.38585437199272,41.79028945276436,123.38536283930766,41.789896494564125,123.38432387278195,41.79028940539239,123.38454728140016,41.79082448839793,123.38563087249528,41.792362844994635,123.38519515839681,41.792647091282724,123.38624525883692,41.794068393526416],title:"沈阳站"}],s=n("c407"),c=function(e){var t=function(e){if(e&&e.get){var t="czm_material czm_getMaterial(czm_materialInput materialInput)\n                    {\n                        czm_material material = czm_getDefaultMaterial(materialInput);\n                        vec2 st = materialInput.st;";return"vertical"==e.freely?t+="vec4 colorImage = texture2D(image, vec2(fract(st.s), fract(float("+e.count+")*st.t"+e.direction+" time)));\n ":t+="vec4 colorImage = texture2D(image, vec2(fract(float("+e.count+")*st.s "+e.direction+" time), fract(st.t)));\n ",t+="vec4 fragColor;\n                        fragColor.rgb = (colorImage.rgb+color.rgb) / 1.0;\n                        fragColor = czm_gammaCorrect(fragColor);\n                        material.diffuse = colorImage.rgb;\n                        material.alpha = colorImage.a;\n                        material.emission = fragColor.rgb;\n                        return material;\n                    }",t}};return{cesiumName:"Material_DynamicWallMaterialPropertys",image:"/cesium-template/Vue/Entity/wall/wl.png",color:e.Color.CYAN,duration:1500,uniforms:{color:new e.Color(1,0,0,.5),image:e.Material.DefaultImageId,time:-20},source:t({get:!0,count:3,freely:"vertical",direction:"-"})}},u=function(e){var t=function(){return"czm_material czm_getMaterial(czm_materialInput materialInput)\n            {\n                 czm_material material = czm_getDefaultMaterial(materialInput);\n                 vec2 st = materialInput.st;\n                 vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n                 material.alpha = colorImage.a * color.a;\n                 material.diffuse = (colorImage.rgb+color.rgb)/2.0;\n                 return material;\n             }"};return{cesiumName:"Material_TrailLineMaterialProperty",image:"/cesium-template/Vue/Entity/wall/flow.png",color:e.Color.RED.withAlpha(.5),duration:15e3,uniforms:{color:new e.Color(1,1,1,1),image:e.Material.DefaultImageId,time:0,constantSpeed:300,depthFailMaterial:!0},source:t()}},m=[{codeLanguage:"VUE",relyOn:[{label:"Entity.js",url:"cesium/Entity.js"},{label:"Materials/index.js",url:"cesium/Materials/index.js"},{label:"Utils.js",url:"cesium/Utils.js"},{label:"DynamicWallMaterialPropertys.js",url:"Vue/Entity/wall/material/DynamicWallMaterialPropertys.js"},{label:"TrailLineMaterialProperty.js",url:"Vue/Entity/wall/material/TrailLineMaterialProperty.js"},{label:"data.js",url:"Vue/Entity/wall/data.js"},{label:"wl.png",url:"Vue/Entity/wall/wl.png"},{label:"flow.png",url:"Vue/Entity/wall/flow.png"}],code:[{codeLanguage:"html",content:'<template>\n                      <div class="container">\n                        <div id="cesiumContainer"></div>\n                        <div class="operation-panel">\n                          <el-select size="mini" v-model="wallType" placeholder="请选择墙体类型">\n                            <el-option\n                              v-for="item in wallTypeArr"\n                              :key="item.value"\n                              :label="item.label"\n                              :value="item.value"\n                            >\n                            </el-option>\n                          </el-select>\n                          <el-button\n                            size="mini"\n                            :disabled="wallType == \'\'"\n                            @click="startDraw"\n                            class="startButton"\n                            type="primary"\n                            plain\n                            >开始绘制</el-button\n                          >\n                        </div>\n                      </div>\n                    </template>'},{codeLanguage:"js",content:'import Material from "@/common/cesium/Materials/index.js";\n                  import Entity from "@/common/cesium/Entity.js";\n                  import wallData from "./module/data.js";//数据\n                  import Utils from "@/common/cesium/Utils.js";\n                  import DynamicWallMaterialPropertys from "./module/material/DynamicWallMaterialPropertys"; //波纹墙\n                  import TrailLineMaterialProperty from "./module/material/TrailLineMaterialProperty"; //流动墙\n                  export default {\n                    name: "wall",\n                    data() {\n                      return {\n                        viewer: null,\n                        _Entity: null,\n                        _Utils: null,\n                        _Material: null,\n                        wallTypeArr: wallData,\n                        wallType: "",\n                      };\n                    },\n                    mounted() {\n                      this.init();\n                    },\n                    methods: {\n                      init() {\n                        const Cesium = this.cesium;\n                        Cesium.Ion.defaultAccessToken = process.env.VUE_APP_TOKEN;\n                        this.viewer = new Cesium.Viewer("cesiumContainer", {\n                          imageryProvider: new Cesium.ArcGisMapServerImageryProvider({\n                            url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",\n                          }),\n                          terrainProvider: new Cesium.CesiumTerrainProvider({\n                            //加载火星在线地形\n                            url: "http://data.marsgis.cn/terrain",\n                          }),\n                          shouldAnimate: true,\n                          infoBox: false,\n                          selectionIndicator: false,\n                        });\n                        //深度监听  在当前效果里可以设置贴地效果\n                        this.viewer.scene.globe.depthTestAgainstTerrain = true;\n                        this._Entity = new Entity(Cesium, this.viewer);\n                        this._Utils = new Utils();\n                        this._Material = new Material(Cesium, this.viewer);\n                      },\n                      /**\n                      * 开始绘制\n                      */\n                      startDraw() {\n                        const Cesium = this.cesium;\n                        //删除所有实体\n                        this._Entity.removeEntity({ type: "all" });\n                        //过滤出来需要的数据对象\n                        const filter_data = this.wallTypeArr.filter(\n                          (item) => item.value == this.wallType\n                        );\n                        if (filter_data.length == 0) return;\n                        const obj = filter_data[0];\n                        let material = null;\n                  \n                        //流动墙\n                        if (obj.value == "1") {\n                          this._Material.create(TrailLineMaterialProperty(Cesium));\n                          material = new Cesium.Material_TrailLineMaterialProperty();\n                        }\n                        //波纹墙\n                        if (obj.value == "2") {\n                          this._Material.create(DynamicWallMaterialPropertys(Cesium));\n                          material = new Cesium.Material_DynamicWallMaterialPropertys();\n                        }\n                  \n                        const positions = Cesium.Cartesian3.fromDegreesArray(obj.position);\n                        const wallEntity = this._Entity.createWall({\n                          positions,\n                          material,\n                          // common: { clampToGround: true },\n                          // 设置高度\n                          maximumHeights: new Array(positions.length).fill(200), //一个属性，它指定要用于墙顶的高度数组，而不是每个位置的高度\n                          minimunHeights: new Array(positions.length).fill(0), //一个属性，它指定要用于墙底而不是地球表面的高度数组。\n                        });\n                        this.viewer.flyTo(wallEntity);\n                      },\n                    },\n                  };'},{codeLanguage:"css",content:".container {\n                      width: 100%;\n                      height: 100%;\n                      #cesiumContainer {\n                        width: 100%;\n                        height: 100%;\n                      }\n                      .operation-panel {\n                        position: fixed;\n                        bottom: 0;\n                        right: 0;\n                        background-color: #fff;\n                        border-radius: 6px 0 0 0;\n                        padding: 20px;\n                        .startButton {\n                          margin-left: 10px;\n                        }\n                      }\n                    }"}]}],p={name:"wall",data:function(){return{viewer:null,_Entity:null,_Utils:null,_Material:null,wallTypeArr:o,wallType:""}},created:function(){this.$store.dispatch("highlight/set_code",m)},mounted:function(){this.init()},methods:{init:function(){var e=this.cesium;e.Ion.defaultAccessToken=Object({NODE_ENV:"production",VUE_APP_BASE_API:"/prod-api",VUE_APP_GAODE_KEY_WEB_SERVICE:"181ced609de9d446207b55e549bafcb6",VUE_APP_GAODE_KEY_WEB_TERMINAL:"cb250acd7ee0e7b2049cb93747ae3d44",VUE_APP_PUBLIC_URL:"/cesium-template",VUE_APP_SECURITY_JS_CODE:"2a0ce2005352672661417093c485a056",BASE_URL:""}).VUE_APP_TOKEN,this.viewer=new e.Viewer("cesiumContainer",{imageryProvider:new e.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),terrainProvider:new e.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"}),shouldAnimate:!0,infoBox:!1,selectionIndicator:!1}),this.viewer.scene.globe.depthTestAgainstTerrain=!0,this._Entity=new l["a"](e,this.viewer),this._Utils=new s["a"],this._Material=new r["a"](e,this.viewer)},startDraw:function(){var e=this,t=this.cesium;this._Entity.removeEntity({type:"all"});var n=this.wallTypeArr.filter((function(t){return t.value==e.wallType}));if(0!=n.length){var i=n[0],a=null;"1"==i.value&&(this._Material.create(u(t)),a=new t.Material_TrailLineMaterialProperty),"2"==i.value&&(this._Material.create(c(t)),a=new t.Material_DynamicWallMaterialPropertys);var r=t.Cartesian3.fromDegreesArray(i.position),l=this._Entity.createWall({positions:r,material:a,maximumHeights:new Array(r.length).fill(200),minimunHeights:new Array(r.length).fill(0)});this.viewer.flyTo(l)}}}},d=p,f=(n("eff1"),n("cba8")),v=Object(f["a"])(d,i,a,!1,null,"103b3412",null);t["default"]=v.exports},bc35:function(e,t,n){"use strict";var i=n("735b"),a=n("32da"),r=n("1c60");e.exports=function(e){var t=i(this),n=r(t),l=arguments.length,o=a(l>1?arguments[1]:void 0,n),s=l>2?arguments[2]:void 0,c=void 0===s?n:a(s,n);while(c>o)t[o++]=e;return t}},c407:function(e,t,n){"use strict";var i=n("4bb1"),a=n("e143"),r=(n("eb3b"),function(){function e(t,n){Object(i["a"])(this,e),this.Cesium=t,this.viewer=n}return Object(a["a"])(e,[{key:"getRandomColor",get:function(){for(var e="#",t=["a","b","c","d","e","f","0","1","2","3","4","5","6","7","8","9"],n=0;n<6;n++){var i=Math.floor(Math.random()*t.length+1)-1;e+=t[i]}return e}},{key:"operationDom",value:function(e,t,n){if("append"===e&&document.getElementById(t).appendChild(n),"remove"===e&&document.getElementById(t).remove(),"has"===e)return document.getElementById(t)}},{key:"debounce",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){var a=this,r=arguments;if(t&&clearTimeout(t),i){var l=!t;t=setTimeout((function(){t=null}),n),l&&e.apply(a,r)}else t=setTimeout((function(){e.apply}),n)}}},{key:"throttle",value:function(e,t,n){var i,a=0;return function(){var r=this,l=arguments;if(1===n){var o=Date.now();o-a>t&&(e.apply(r,l),a=o)}else 2===n&&(i||(i=setTimeout((function(){i=null,e.apply(r,l)}),t)))}}},{key:"createScript",value:function(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"loadJs",value:function(e,t){return new Promise((function(n,i){var a=document.createElement("script");a.type="text/javascript",null!==t&&void 0!==t&&t.async&&t.async&&(a.async="async"),null!==t&&void 0!==t&&t.defer&&t.defer&&(a.defer="defer");var r="body";null!==t&&void 0!==t&&t.append&&t.append&&("body"==t.append||"head"==t.append)&&(r=t.append),a.src=e,document[r].appendChild(a),a.onload=function(){n()},a.onerror=function(){i()}}))}}]),e}());t["a"]=r},e143:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,"a",(function(){return a}))},eff1:function(e,t,n){"use strict";n("7d42")}}]);